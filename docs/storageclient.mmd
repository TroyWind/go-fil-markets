stateDiagram-v2
	state "StorageDealUnknown" as 0
	state "StorageDealProposalAccepted" as 3
	state "StorageDealSealing" as 5
	state "StorageDealActive" as 6
	state "StorageDealExpired" as 7
	state "StorageDealSlashed" as 8
	state "StorageDealFailing" as 9
	state "StorageDealFundsEnsured" as 10
	state "StorageDealCheckForAcceptance" as 12
	state "StorageDealStartDataTransfer" as 15
	state "StorageDealTransferring" as 16
	state "StorageDealEnsureClientFunds" as 20
	state "StorageDealClientFunding" as 22
	state "StorageDealError" as 25
	3 : On entry runs ValidateDealPublished
	5 : On entry runs VerifyDealActivated
	6 : On entry runs WaitForDealCompletion
	9 : On entry runs FailDeal
	10 : On entry runs ProposeDeal
	12 : On entry runs CheckForDealAcceptance
	15 : On entry runs InitiateDataTransfer
	20 : On entry runs EnsureClientFunds
	22 : On entry runs WaitForFunding
	[*] --> 0
	note right of 0
		The following events are not shown cause they can trigger from any state.

		ClientEventStreamCloseError - transitions state to StorageDealError
		ClientEventRestart - does not transition state
	end note
	0 --> 20 : ClientEventOpen
	20 --> 22 : ClientEventFundingInitiated
	20 --> 9 : ClientEventEnsureFundsFailed
	22 --> 9 : ClientEventEnsureFundsFailed
	20 --> 10 : ClientEventFundsEnsured
	22 --> 10 : ClientEventFundsEnsured
	10 --> 25 : ClientEventWriteProposalFailed
	10 --> 9 : ClientEventReadResponseFailed
	10 --> 9 : ClientEventResponseVerificationFailed
	10 --> 15 : ClientEventInitiateDataTransfer
	10 --> 9 : ClientEventUnexpectedDealState
	15 --> 9 : ClientEventDataTransferFailed
	16 --> 9 : ClientEventDataTransferFailed
	15 --> 16 : ClientEventDataTransferInitiated
	15 --> 12 : ClientEventDataTransferComplete
	16 --> 12 : ClientEventDataTransferComplete
	12 --> 12 : ClientEventWaitForDealState
	12 --> 9 : ClientEventResponseDealDidNotMatch
	12 --> 9 : ClientEventDealRejected
	12 --> 3 : ClientEventDealAccepted
	3 --> 25 : ClientEventDealPublishFailed
	3 --> 5 : ClientEventDealPublished
	5 --> 25 : ClientEventDealActivationFailed
	5 --> 6 : ClientEventDealActivated
	6 --> 8 : ClientEventDealSlashed
	6 --> 7 : ClientEventDealExpired
	6 --> 25 : ClientEventDealCompletionFailed
	9 --> 25 : ClientEventFailed
	8 --> [*]
	7 --> [*]
	25 --> [*]
